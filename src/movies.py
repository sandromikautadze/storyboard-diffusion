"""
movies.py

This module defines movie scripts and character details a list of predefined movies.

Authors: Sandro Mikautadze, Elio Samaha.
"""

from typing import Dict, Tuple

godfather_offer_scene = {
    "title": "The Godfather - Offer Scene",
    "script": """
INT DAY: DON'S OFFICE (SUMMER 1945)

				DON CORLEONE
		ACT LIKE A MAN!  By Christ in
		Heaven, is it possible you turned
		out no better than a Hollywood
		finocchio.

	Both HAGEN and JOHNNY cannot refrain from laughing.  The DON
	smiles.  SONNY enters as noiselessly as possible, still
	adjusting his clothes.

				DON CORLEONE
		All right, Hollywood...Now tell me
		about this Hollywood Pezzonovanta
		who won't let you work.

				JOHNNY
		He owns the studio.  Just a month
		ago he bought the movie rights to
		this book, a best seller.  And the
		main character is a guy just like
		me.  I wouldn't even have to act,
		just be myself.

	The DON is silent, stern.

				DON CORLEONE
		You take care of your family?

				JOHNNY
		Sure.

	He glances at SONNY, who makes himself as inconspicuous as
	he can.

				DON CORLEONE
		You look terrible.  I want you to
		eat well, to rest.  And spend time
		with your family.  And then, at the
		end of the month, this big shot
		will give you the part you want.

				JOHNNY
		It's too late.  All the contracts
		have been signed, they're almost
		ready to shoot.

				DON CORLEONE
		I'll make him an offer he can't
		refuse.

	He takes JOHNNY to the door, pinching his cheek hard enough
	to hurt.

				DON CORLEONE
		Now go back to the party and leave
		it to me.

	He closes the door, smiling to himself.  Turns to HAGEN.

				DON CORLEONE
		When does my daughter leave with
		her bridegroom?

				HAGEN
		They'll cut the cake in a few
		minutes...leave right after that.
		Your new son-in-law, do we give him
		something important?

				DON CORLEONE
		No, give him a living.  But never
		let him know the family's business.
		What else, Tom?

				HAGEN
		I've called the hospital; they've
		notified Consiglere Genco's family
		to come and wait.  He won't last
		out the night.

	This saddens the DON.  He sighs.

				DON CORLEONE
		Genco will wait for me.  Santino,
		tell your brothers they will come
		with me to the hospital to see
		Genco.  Tell Fredo to drive the big
		car, and ask Johnny to come with us.

				SONNY
		And Michael?

				DON CORLEONE
		All my sons.
			  (to HAGEN)
		Tom, I want you to go to California
		tonight.  Make the arrangements.
		But don't leave until I come back
		from the hospital and speak to you.
		Understood?

				HAGEN
		Understood.
""",
    "characters": {
    "Don Vito Corleone": {
        "age": "early 60s", "gender": "male", "hair": "slicked-back gray-black hair",
        "clothing": "dark three-piece suit",
        "body_type": "stocky, slightly hunched posture",
        "accessories": "gold ring on right hand, pocket watch",
        "ethnicity": "Italian-American"
    },
    "Tom Hagen": {
        "age": "early 40s", "gender": "male", "hair": "short, neatly combed brown hair",
        "facial_hair": "clean-shaven", "clothing": "gray suit, dark tie",
        "body_type": "medium build, upright posture", "ethnicity": "German-Irish"
    },
    "Johnny Fontane": {
        "age": "late 30s", "gender": "male", "hair": "short, slicked-back black hair",
        "facial_hair": "clean shaven", "clothing": "dark, stylish suit with an open collar",
        "body_type": "slim and fit", "accessories": "gold ring, cigarette"
    },
    "Sonny": {
        "age": "early 30s", "gender": "male", "hair": "curly, dark brown hair",
        "facial_hair": "clean-shaven", "clothing": "formal suit, slightly disheveled",
        "body_type": "athletic build", "ethnicity": "Italian-American",
    }

}
}

titanic_finale_scene = {
    "title": "Titanic - Dramatic Finale",
    "script": """
EXT. OCEAN 291
IN A HOVERING DOWNANGLE we see Jack and Rose floating in the black water.
The stars reflect in the mill pond surface, and the two of them seem to be floating in interstellar space.
They are absolutely still. Their hands are locked together.
Rose is staring upwards at the canopy of stars wheeling above her.
The music is transparent, floating...as the long sleep steals over Rose, and she feels peace.
CLOSE ON Rose's face. Pale, like the faces of the dead.
She seems to be floating in a void. Rose is in a semihallucinatory state. She knows she is dying. Her lips
barely move as she sings a scrap of Jack's song:
ROSE
"Come Josephine in my flying machine..."
ROSE'S POV: The stars. Like you've never seen them. The
Milky Way a glorious band from horizon to horizon.
A SHOOTING STAR flares... a line of light across the
heavens.
TIGHT ON ROSE again. We see that her hair is dusted with
frost crystals. Her breathing is so shallow, she is almost
motionless. Her eyes track down from the stars to the
water.
ROSE'S POV... SLOW MOTION: The silhouette of a boat
crossing the stars. She sees men in it, rowing so slowly
the oars lift out of the syrupy water, leaving weightless
pearls floating in the air. The VOICES of the men sound
slow and DISTORTED.
Then the lookout flashes his torch toward her and the light
flares across the water, silhouetting the bobbing corpses in
between. It flicks past her motionless form and moves on.
The boat is 50 feet away, and moving past her. The men look
away.
Rose lifts her head to turn to Jack. We see that her hair
has frozen to the wood under her.

    ROSE
    (barely audible)
    Jack.

She touches his shoulder with her free hand. He doesn't respond. Rose gently turns his face toward her.
It is rimed with frost. He seems to be sleeping peacefully. But he is not asleep.
Rose can only stare at his still face as the realization goes through her.
    ROSE
    Oh, Jack.
    
All hope, will and spirit leave her. She looks at the boat.
It is further away now, the voices fainter. Rose watches them go.
She closes her eyes. She is so weak, and there just seems to be no reason to even try.
And then... her eyes snap open.
She raises her head suddenly, cracking the ice as she rips her hair off the wood.
She calls out, but her voice is so weak they don't hear her.
The boat is invisible now, the torch light a star impossibly far away.
She struggles to draw breath, calling again. 

ROSE struggles to move. Her hand, she realizes, is actually frozen to Jack's.
She breaths on it, melting the ice a little, and gently unclasps their hands, breaking away
a thin tinkling film.

    ROSE
    I won't let go. I promise.

She releases him and he sinks into the black water. He seems to fade out like a spirit returning to some immaterial plane.
Rose rolls off the floating staircase and plunges into the icy water. She swims to Chief Officer Wilde's body and grabs his whistle.
She starts to BLOW THE WHISTLE with all the strength in her body. Its sound slaps across the still water.
""",
    "characters": {
        "Rose": {
            "age": "early 20s",
            "gender": "female",
            "hair": "long, dark brown",
            "clothing": "dress, all wet",
            "body_type": "fit",
            "ethnicity": "American",
            "facial_hair": "",
            "accessories": ""
        },
        "Jack": {
            "age": "early 20s",
            "gender": "male",
            "hair": "medium length, blonde",
            "clothing": "shirt, all wet",
            "body_type": "fit",
            "ethnicity": "American",
            "facial_hair": "clean shaven",
            "accessories": ""
        },
    }
}

movie_scripts = {
    "the godfather": godfather_offer_scene,
    "titanic": titanic_finale_scene,
}

def get_movie_data(movie_title: str) -> Tuple[str, Dict[str, Dict[str, str]]]:
    """
    Get the script and character details for a given movie title
    """
    movie_key = movie_title.lower()
    if movie_key not in movie_scripts:
        raise ValueError(f"Movie '{movie_title}' not in the list. Available movies: {list(movie_scripts.keys())}")
    data = movie_scripts[movie_key]
    script = data["script"]
    characters = data["characters"]
    return script, characters
